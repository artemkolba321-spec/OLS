#!/usr/bin/env bash
# OLS command: nurl

set -euo pipefail
IFS=$'\n\t'

source "$HOME/OLS/lib/env.sh"

# ===== Helpers =====
show_help() {
    cat <<'EOF'
nurl - Net URL Load (download files from the web)

usage:
    nurl <URL>         Download a file from the given URL
    nurl --help        Show this help message

description:
    Downloads files from HTTP/HTTPS URLs using wget.
    The file is saved to the current directory.
    You can also pipe the output to other commands.

requires:
    wget

examples:
    nurl https://example.com/file.zip         download a file
    nurl https://example.com/ > index.html    save page as HTML
    nurl https://example.com/ | less          view page content
EOF
}


# ===== Args =====
[[ $# -eq 0 ]] && show_help && exit 0
command -v wget >/dev/null 2>&1 || warn "wget not found"

# ===== Main =====
case "$1" in
    --help)
        show_help
        exit 0
        ;;
    *)
        if [[ "$1" == http://* || "$1" == https://* ]]; then
            wget "$1"
            info "fetch $1"
        else
            ee "invalid argument: $1"
        fi
        ;;
esac
